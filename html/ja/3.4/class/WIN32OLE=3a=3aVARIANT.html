<!DOCTYPE html>
<html lang="ja-JP">
<head>
<!-- Global Site Tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-620926-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments)};
  gtag('js', new Date());

  gtag('config', 'UA-620926-3');
</script>

<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="../style.css">
<link rel="stylesheet" href="../syntax-highlight.css">
<link rel="icon" type="image/png" href="../rurema.png">

<link rel="canonical" href="https://docs.ruby-lang.org/ja/latest/class/WIN32OLE=3a=3aVARIANT.html">

<title>module WIN32OLE::VARIANT (Ruby 3.4 リファレンスマニュアル)</title>
<meta name="description" content="OLEオートメーション型を指定するための定数を定義したモジュールです。">
<script src="../script.js"></script>
</head>
<body>


<script type="application/ld+json">
{"@context":"http://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","item":"https://docs.ruby-lang.org/ja/latest/doc/index.html","name":"Ruby 3.4 リファレンスマニュアル","position":1},{"@type":"ListItem","item":"https://docs.ruby-lang.org/ja/latest/library/index.html","name":"ライブラリ一覧","position":2},{"@type":"ListItem","item":"https://docs.ruby-lang.org/ja/latest/library/win32ole.html","name":"win32oleライブラリ","position":3},{"@type":"ListItem","item":"https://docs.ruby-lang.org/ja/latest/class/WIN32OLE=3a=3aVARIANT.html","name":"WIN32OLE::VARIANTモジュール","position":4}]}
</script>

<header>
  <nav>
    <ol class="inline-breadcrumb-list">
      <li>
        <a href="../doc/index.html">Ruby 3.4 リファレンスマニュアル</a>
      </li>
      <li>
        <a href="../library/index.html">ライブラリ一覧</a>
      </li>
      <li>
        <a href="../library/win32ole.html">win32oleライブラリ</a>
      </li>
      <li>
        WIN32OLE::VARIANTモジュール
      </li>
    </ol>
  </nav>

<h1>module WIN32OLE::VARIANT</h1><span class="permalink">[<a href="https://github.com/rurema/doctree/edit/master/refm/api/src/win32ole.rd#L41">edit</a>]</span>

</header>

<main>



  <nav>
    クラス・モジュールの継承リスト:
    <ol class="inline-ancestors-list">
      
      <li>
        WIN32OLE::VARIANT
      </li>
    </ol>
  </nav>











<h2>要約</h2>
<p>
OLEオートメーション型を指定するための定数を定義したモジュールです。
</p>
<p>
WIN32OLE::VARIANTは、<a href="../class/WIN32OLE_VARIANT.html">WIN32OLE_VARIANT</a>オブジェクトの作成時や、
<a href="../method/WIN32OLE/i/_invoke.html">WIN32OLE#_invoke</a>などのメソッド呼び出し時に、ユーザがRubyのオブジェクトの変換方法を指定するための定数を提供します。
</p>
<p>
これらの値は、COMの仕様で定義されたOLEオートメーション型と呼ばれる一連の型を決定する定数です。ただし、一部、OLEオートメーション非互換の型も定義されているため、利用時にはOLEオートメーション互換型のみを利用するようにしてください。
</p>



<h2>目次</h2>
<dl>

<dt>定数</dt>
<dd>
<ul class="class-toc">

<li><a href="#C_-V-T_-A-R-R-A-Y">VT_ARRAY</a></li>

<li><a href="#C_-V-T_-B-O-O-L">VT_BOOL</a></li>

<li><a href="#C_-V-T_-B-S-T-R">VT_BSTR</a></li>

<li><a href="#C_-V-T_-B-Y-R-E-F">VT_BYREF</a></li>

<li><a href="#C_-V-T_-C-Y">VT_CY</a></li>

<li><a href="#C_-V-T_-D-A-T-E">VT_DATE</a></li>

<li><a href="#C_-V-T_-D-I-S-P-A-T-C-H">VT_DISPATCH</a></li>

<li><a href="#C_-V-T_-E-M-P-T-Y">VT_EMPTY</a></li>

<li><a href="#C_-V-T_-E-R-R-O-R">VT_ERROR</a></li>

<li><a href="#C_-V-T_-I1">VT_I1</a></li>

<li><a href="#C_-V-T_-I2">VT_I2</a></li>

<li><a href="#C_-V-T_-I4">VT_I4</a></li>

<li><a href="#C_-V-T_-I-N-T">VT_INT</a></li>

<li><a href="#C_-V-T_-N-U-L-L">VT_NULL</a></li>

<li><a href="#C_-V-T_-P-T-R">VT_PTR</a></li>

<li><a href="#C_-V-T_-R4">VT_R4</a></li>

<li><a href="#C_-V-T_-R8">VT_R8</a></li>

<li><a href="#C_-V-T_-U-I1">VT_UI1</a></li>

<li><a href="#C_-V-T_-U-I2">VT_UI2</a></li>

<li><a href="#C_-V-T_-U-I4">VT_UI4</a></li>

<li><a href="#C_-V-T_-U-I-N-T">VT_UINT</a></li>

<li><a href="#C_-V-T_-U-N-K-N-O-W-N">VT_UNKNOWN</a></li>

<li><a href="#C_-V-T_-U-S-E-R-D-E-F-I-N-E-D">VT_USERDEFINED</a></li>

<li><a href="#C_-V-T_-V-A-R-I-A-N-T">VT_VARIANT</a></li>

</ul>
</dd>

</dl>




</dl>


<h2>定数</h2>
<dl>

<dt class="method-heading" id="C_-V-T_-A-R-R-A-Y"><code>VT_ARRAY -&gt; Integer</code><span class="permalink">[<a href="../method/WIN32OLE=3a=3aVARIANT/c/VT_ARRAY.html">permalink</a>][<a href="https://docs.ruby-lang.org/en/3.4/WIN32OLE/VARIANT.html#method-c-VT_ARRAY">rdoc</a>][<a href="https://github.com/rurema/doctree/edit/master/refm/api/src/win32ole.rd#L55">edit</a>]</span></dt>
<dd class="method-description">
<p>
配列（SafeArray）を示します（0x2000）。
</p>
</dd>


<dt class="method-heading" id="C_-V-T_-B-O-O-L"><code>VT_BOOL -&gt; Integer</code><span class="permalink">[<a href="../method/WIN32OLE=3a=3aVARIANT/c/VT_BOOL.html">permalink</a>][<a href="https://docs.ruby-lang.org/en/3.4/WIN32OLE/VARIANT.html#method-c-VT_BOOL">rdoc</a>][<a href="https://github.com/rurema/doctree/edit/master/refm/api/src/win32ole.rd#L58">edit</a>]</span></dt>
<dd class="method-description">
<p>
真偽値を示します（11）。
</p>
</dd>


<dt class="method-heading" id="C_-V-T_-B-S-T-R"><code>VT_BSTR -&gt; Integer</code><span class="permalink">[<a href="../method/WIN32OLE=3a=3aVARIANT/c/VT_BSTR.html">permalink</a>][<a href="https://docs.ruby-lang.org/en/3.4/WIN32OLE/VARIANT.html#method-c-VT_BSTR">rdoc</a>][<a href="https://github.com/rurema/doctree/edit/master/refm/api/src/win32ole.rd#L61">edit</a>]</span></dt>
<dd class="method-description">
<p>
文字列（BSTR）を示します（8）。
</p>
<p>
OLEオートメーションのBSTRはUnicodeで表現された長さ付き文字列です。Ruby
のStringとBSTRの相互変換は、WIN32OLEが<a href="../method/WIN32OLE/i/codepage.html">WIN32OLE#codepage</a>に基づいて自動的に行います。
</p>
</dd>


<dt class="method-heading" id="C_-V-T_-B-Y-R-E-F"><code>VT_BYREF -&gt; Integer</code><span class="permalink">[<a href="../method/WIN32OLE=3a=3aVARIANT/c/VT_BYREF.html">permalink</a>][<a href="https://docs.ruby-lang.org/en/3.4/WIN32OLE/VARIANT.html#method-c-VT_BYREF">rdoc</a>][<a href="https://github.com/rurema/doctree/edit/master/refm/api/src/win32ole.rd#L68">edit</a>]</span></dt>
<dd class="method-description">
<p>
参照を示します（0x4000）。
</p>
<p>
VT_BYREFは型ではなく、参照を示す型属性です。OLEオートメーションサーバが結果を引数に戻す場合、参照先の型を示す値と論理和を取るために利用します。
</p>
</dd>


<dt class="method-heading" id="C_-V-T_-C-Y"><code>VT_CY -&gt; Integer</code><span class="permalink">[<a href="../method/WIN32OLE=3a=3aVARIANT/c/VT_CY.html">permalink</a>][<a href="https://docs.ruby-lang.org/en/3.4/WIN32OLE/VARIANT.html#method-c-VT_CY">rdoc</a>][<a href="https://github.com/rurema/doctree/edit/master/refm/api/src/win32ole.rd#L74">edit</a>]</span></dt>
<dd class="method-description">
<p>
通貨型（CURRENCY）を示します（6）。
</p>
<p>
OLEオートメーションのCURRENCY型は、符号付き64ビット整数を10進表記した時の下4桁を小数点以下とすることで、加減算について誤差を生じさせない小数点数を表現します。
</p>
<p>
CURRENCY型の有効範囲は-922337203685477.5808から922337203685477.5807です。
</p>
<p>
WIN32OLEはオートメーション呼び出しの返り値がCURRENCY型の場合、文字列に変換します。
</p>
</dd>


<dt class="method-heading" id="C_-V-T_-D-A-T-E"><code>VT_DATE -&gt; Integer</code><span class="permalink">[<a href="../method/WIN32OLE=3a=3aVARIANT/c/VT_DATE.html">permalink</a>][<a href="https://docs.ruby-lang.org/en/3.4/WIN32OLE/VARIANT.html#method-c-VT_DATE">rdoc</a>][<a href="https://github.com/rurema/doctree/edit/master/refm/api/src/win32ole.rd#L86">edit</a>]</span></dt>
<dd class="method-description">
<p>
日付型（DATE）を示します（7）。
</p>
<p>
OLEオートメーションのDATE型は、1899年12月30日0時00分からの日時を示す64
ビット浮動小数点数型です。
</p>
<p>
WIN32OLEは、RubyのTime型と自動的に変換します。
</p>
</dd>


<dt class="method-heading" id="C_-V-T_-D-I-S-P-A-T-C-H"><code>VT_DISPATCH -&gt; Integer</code><span class="permalink">[<a href="../method/WIN32OLE=3a=3aVARIANT/c/VT_DISPATCH.html">permalink</a>][<a href="https://docs.ruby-lang.org/en/3.4/WIN32OLE/VARIANT.html#method-c-VT_DISPATCH">rdoc</a>][<a href="https://github.com/rurema/doctree/edit/master/refm/api/src/win32ole.rd#L94">edit</a>]</span></dt>
<dd class="method-description">
<p>
OLEオートメーションオブジェクトを示します（9）。
</p>
<p>
RubyのオブジェクトをOLEオートメーションサーバへ与える場合に利用します。
</p>
</dd>


<dt class="method-heading" id="C_-V-T_-E-M-P-T-Y"><code>VT_EMPTY -&gt; Integer</code><span class="permalink">[<a href="../method/WIN32OLE=3a=3aVARIANT/c/VT_EMPTY.html">permalink</a>][<a href="https://docs.ruby-lang.org/en/3.4/WIN32OLE/VARIANT.html#method-c-VT_EMPTY">rdoc</a>][<a href="https://github.com/rurema/doctree/edit/master/refm/api/src/win32ole.rd#L162">edit</a>]</span></dt>
<dd class="method-description">
<p>
空（初期化状態）のオブジェクトを示します（0）。
</p>
</dd>


<dt class="method-heading" id="C_-V-T_-E-R-R-O-R"><code>VT_ERROR -&gt; Integer</code><span class="permalink">[<a href="../method/WIN32OLE=3a=3aVARIANT/c/VT_ERROR.html">permalink</a>][<a href="https://docs.ruby-lang.org/en/3.4/WIN32OLE/VARIANT.html#method-c-VT_ERROR">rdoc</a>][<a href="https://github.com/rurema/doctree/edit/master/refm/api/src/win32ole.rd#L99">edit</a>]</span></dt>
<dd class="method-description">
<p>
HRESULTを示します（10）。
</p>
<p>
HRESULTは、COMを含むWindowsのサービスがアプリケーションへ通知する統一的なエラーコードです。
</p>
<p>
HRESULT: <a class="external" href="http://msdn.microsoft.com/en-us/library/cc704587(v=PROT.10).aspx">http://msdn.microsoft.com/en-us/library/cc704587(v=PROT.10).aspx</a>
</p>
</dd>


<dt class="method-heading" id="C_-V-T_-I1"><code>VT_I1 -&gt; Integer</code><span class="permalink">[<a href="../method/WIN32OLE=3a=3aVARIANT/c/VT_I1.html">permalink</a>][<a href="https://docs.ruby-lang.org/en/3.4/WIN32OLE/VARIANT.html#method-c-VT_I1">rdoc</a>][<a href="https://github.com/rurema/doctree/edit/master/refm/api/src/win32ole.rd#L107">edit</a>]</span></dt>
<dd class="method-description">
<p>
符号付き8ビット整数（char）を示します（16）。
</p>
<p>
OLEオートメーションの仕様上は利用できません。
</p>
</dd>


<dt class="method-heading" id="C_-V-T_-I2"><code>VT_I2 -&gt; Integer</code><span class="permalink">[<a href="../method/WIN32OLE=3a=3aVARIANT/c/VT_I2.html">permalink</a>][<a href="https://docs.ruby-lang.org/en/3.4/WIN32OLE/VARIANT.html#method-c-VT_I2">rdoc</a>][<a href="https://github.com/rurema/doctree/edit/master/refm/api/src/win32ole.rd#L112">edit</a>]</span></dt>
<dd class="method-description">
<p>
符号付き16ビット整数（short）を示します（2）。
</p>
</dd>


<dt class="method-heading" id="C_-V-T_-I4"><code>VT_I4 -&gt; Integer</code><span class="permalink">[<a href="../method/WIN32OLE=3a=3aVARIANT/c/VT_I4.html">permalink</a>][<a href="https://docs.ruby-lang.org/en/3.4/WIN32OLE/VARIANT.html#method-c-VT_I4">rdoc</a>][<a href="https://github.com/rurema/doctree/edit/master/refm/api/src/win32ole.rd#L115">edit</a>]</span></dt>
<dd class="method-description">
<p>
符号付き32ビット整数（int）を示します（3）。
</p>
</dd>


<dt class="method-heading" id="C_-V-T_-I-N-T"><code>VT_INT -&gt; Integer</code><span class="permalink">[<a href="../method/WIN32OLE=3a=3aVARIANT/c/VT_INT.html">permalink</a>][<a href="https://docs.ruby-lang.org/en/3.4/WIN32OLE/VARIANT.html#method-c-VT_INT">rdoc</a>][<a href="https://github.com/rurema/doctree/edit/master/refm/api/src/win32ole.rd#L118">edit</a>]</span></dt>
<dd class="method-description">
<p>
符号付き整数（int）を示します（22）。
</p>
</dd>


<dt class="method-heading" id="C_-V-T_-N-U-L-L"><code>VT_NULL -&gt; Integer</code><span class="permalink">[<a href="../method/WIN32OLE=3a=3aVARIANT/c/VT_NULL.html">permalink</a>][<a href="https://docs.ruby-lang.org/en/3.4/WIN32OLE/VARIANT.html#method-c-VT_NULL">rdoc</a>][<a href="https://github.com/rurema/doctree/edit/master/refm/api/src/win32ole.rd#L165">edit</a>]</span></dt>
<dd class="method-description">
<p>
NULL型の値を示します（1）。
</p>
<p>
<a href="../method/WIN32OLE=3a=3aVARIANT/s/VT_EMPTY.html">WIN32OLE::VARIANT.VT_EMPTY</a>と異なり、NULLという値（たとえばSQLパラメータでNULLを指定する場合など）を示します。
</p>
</dd>


<dt class="method-heading" id="C_-V-T_-P-T-R"><code>VT_PTR -&gt; Integer</code><span class="permalink">[<a href="../method/WIN32OLE=3a=3aVARIANT/c/VT_PTR.html">permalink</a>][<a href="https://docs.ruby-lang.org/en/3.4/WIN32OLE/VARIANT.html#method-c-VT_PTR">rdoc</a>][<a href="https://github.com/rurema/doctree/edit/master/refm/api/src/win32ole.rd#L121">edit</a>]</span></dt>
<dd class="method-description">
<p>
ポインタ型を示します（26）。
</p>
<p>
VT_PTRは、VOID*に相当するため、OLEオートメーションでは利用できません。
</p>
</dd>


<dt class="method-heading" id="C_-V-T_-R4"><code>VT_R4 -&gt; Integer</code><span class="permalink">[<a href="../method/WIN32OLE=3a=3aVARIANT/c/VT_R4.html">permalink</a>][<a href="https://docs.ruby-lang.org/en/3.4/WIN32OLE/VARIANT.html#method-c-VT_R4">rdoc</a>][<a href="https://github.com/rurema/doctree/edit/master/refm/api/src/win32ole.rd#L126">edit</a>]</span></dt>
<dd class="method-description">
<p>
単精度浮動小数点数を示します（4）。
</p>
</dd>


<dt class="method-heading" id="C_-V-T_-R8"><code>VT_R8 -&gt; Integer</code><span class="permalink">[<a href="../method/WIN32OLE=3a=3aVARIANT/c/VT_R8.html">permalink</a>][<a href="https://docs.ruby-lang.org/en/3.4/WIN32OLE/VARIANT.html#method-c-VT_R8">rdoc</a>][<a href="https://github.com/rurema/doctree/edit/master/refm/api/src/win32ole.rd#L129">edit</a>]</span></dt>
<dd class="method-description">
<p>
倍精度浮動小数点数を示します（5）。
</p>
</dd>


<dt class="method-heading" id="C_-V-T_-U-I1"><code>VT_UI1 -&gt; Integer</code><span class="permalink">[<a href="../method/WIN32OLE=3a=3aVARIANT/c/VT_UI1.html">permalink</a>][<a href="https://docs.ruby-lang.org/en/3.4/WIN32OLE/VARIANT.html#method-c-VT_UI1">rdoc</a>][<a href="https://github.com/rurema/doctree/edit/master/refm/api/src/win32ole.rd#L132">edit</a>]</span></dt>
<dd class="method-description">
<p>
符号なし8ビット整数（unsigned char）を示します（17）。
</p>
</dd>


<dt class="method-heading" id="C_-V-T_-U-I2"><code>VT_UI2 -&gt; Integer</code><span class="permalink">[<a href="../method/WIN32OLE=3a=3aVARIANT/c/VT_UI2.html">permalink</a>][<a href="https://docs.ruby-lang.org/en/3.4/WIN32OLE/VARIANT.html#method-c-VT_UI2">rdoc</a>][<a href="https://github.com/rurema/doctree/edit/master/refm/api/src/win32ole.rd#L135">edit</a>]</span></dt>
<dd class="method-description">
<p>
符号なし16ビット整数（unsigned short）を示します（18）。
</p>
<p>
OLEオートメーションでは利用できません。代わりにVT_I2を利用してください。
</p>
</dd>


<dt class="method-heading" id="C_-V-T_-U-I4"><code>VT_UI4 -&gt; Integer</code><span class="permalink">[<a href="../method/WIN32OLE=3a=3aVARIANT/c/VT_UI4.html">permalink</a>][<a href="https://docs.ruby-lang.org/en/3.4/WIN32OLE/VARIANT.html#method-c-VT_UI4">rdoc</a>][<a href="https://github.com/rurema/doctree/edit/master/refm/api/src/win32ole.rd#L140">edit</a>]</span></dt>
<dd class="method-description">
<p>
符号なし32ビット整数（unsigned int）を示します（19）。
</p>
<p>
OLEオートメーションでは利用できません。代わりにVT_I4を利用してください。
</p>
</dd>


<dt class="method-heading" id="C_-V-T_-U-I-N-T"><code>VT_UINT -&gt; Integer</code><span class="permalink">[<a href="../method/WIN32OLE=3a=3aVARIANT/c/VT_UINT.html">permalink</a>][<a href="https://docs.ruby-lang.org/en/3.4/WIN32OLE/VARIANT.html#method-c-VT_UINT">rdoc</a>][<a href="https://github.com/rurema/doctree/edit/master/refm/api/src/win32ole.rd#L145">edit</a>]</span></dt>
<dd class="method-description">
<p>
符号なし整数（unsigned int）を示します（23）。
</p>
<p>
OLEオートメーションでは利用できません。代わりにVT_I4を利用してください。
</p>
</dd>


<dt class="method-heading" id="C_-V-T_-U-N-K-N-O-W-N"><code>VT_UNKNOWN -&gt; Integer</code><span class="permalink">[<a href="../method/WIN32OLE=3a=3aVARIANT/c/VT_UNKNOWN.html">permalink</a>][<a href="https://docs.ruby-lang.org/en/3.4/WIN32OLE/VARIANT.html#method-c-VT_UNKNOWN">rdoc</a>][<a href="https://github.com/rurema/doctree/edit/master/refm/api/src/win32ole.rd#L150">edit</a>]</span></dt>
<dd class="method-description">
<p>
COMインターフェイスを示します（13）。
</p>
</dd>


<dt class="method-heading" id="C_-V-T_-U-S-E-R-D-E-F-I-N-E-D"><code>VT_USERDEFINED -&gt; Integer</code><span class="permalink">[<a href="../method/WIN32OLE=3a=3aVARIANT/c/VT_USERDEFINED.html">permalink</a>][<a href="https://docs.ruby-lang.org/en/3.4/WIN32OLE/VARIANT.html#method-c-VT_USERDEFINED">rdoc</a>][<a href="https://github.com/rurema/doctree/edit/master/refm/api/src/win32ole.rd#L153">edit</a>]</span></dt>
<dd class="method-description">
<p>
ユーザ定義型を示します（29）。
</p>
<p>
OLEオートメーションでは利用できません。代わりにVT_I4を利用してください。
</p>
</dd>


<dt class="method-heading" id="C_-V-T_-V-A-R-I-A-N-T"><code>VT_VARIANT -&gt; Integer</code><span class="permalink">[<a href="../method/WIN32OLE=3a=3aVARIANT/c/VT_VARIANT.html">permalink</a>][<a href="https://docs.ruby-lang.org/en/3.4/WIN32OLE/VARIANT.html#method-c-VT_VARIANT">rdoc</a>][<a href="https://github.com/rurema/doctree/edit/master/refm/api/src/win32ole.rd#L158">edit</a>]</span></dt>
<dd class="method-description">
<p>
VARIANT型を示します（12）。
</p>
</dd>


</dl>

</main>

<footer id="footer">
  <a rel="license" href="https://creativecommons.org/licenses/by/3.0/">
    <img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by/3.0/88x31.png" />
  </a>

  <a href="https://github.com/rurema/doctree/issues/new" id="feedback-link">フィードバックを送る</a>
  
    / <a href="https://github.com/rurema/doctree/edit/master/refm/api/src/win32ole.rd#L41">このマニュアルを編集する</a>
  
  <script>if (window.URLSearchParams) { document.getElementById("feedback-link").search = new URLSearchParams({'body': document.location}); }</script>
</footer>
</body>
</html>
